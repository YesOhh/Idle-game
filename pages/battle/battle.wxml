<!-- pages/battle/battle.wxml -->
<view class="battle-container">
  <!-- Bossä¿¡æ¯åŒºåŸŸ -->
  <view class="boss-section">
    <view class="boss-level">Boss Lv.{{boss.level}}</view>
    
    <!-- Bossç²¾çµ -->
    <view class="boss-sprite" bindtap="onTapBoss">
      <view class="boss-icon {{attacking ? 'shake' : ''}}">ğŸ‘¹</view>
      
      <!-- ä¼¤å®³æ•°å­—åŠ¨ç”» -->
      <view wx:for="{{damageNumbers}}" wx:key="id" class="damage-number" 
            style="left: {{item.x}}rpx; top: {{item.y}}rpx; animation-delay: {{item.delay}}ms">
        {{item.damage}}
      </view>
    </view>
    
    <!-- Bossè¡€æ¡ -->
    <view class="boss-hp-container">
      <view class="boss-hp-label">
        <text>{{bossHpText}}</text>
      </view>
      <view class="pixel-progress">
        <view class="pixel-progress-fill" style="width: {{bossHpPercent}}%"></view>
      </view>
    </view>
  </view>
  
  <!-- ç´§å‡‘çš„ç»Ÿè®¡ä¿¡æ¯ -->
  <view class="stats-compact">
    <view class="stat-compact">
      <text class="stat-compact-label">ğŸ’°</text>
      <text class="stat-compact-value">{{goldText}}</text>
    </view>
    <view class="stat-compact">
      <text class="stat-compact-label">âš”ï¸</text>
      <text class="stat-compact-value">{{manualDamageText}}</text>
    </view>
    <view class="stat-compact">
      <text class="stat-compact-label">ğŸ”¥</text>
      <text class="stat-compact-value">{{dpsText}}/s</text>
    </view>
  </view>
  
  <!-- ä½£å…µåˆ—è¡¨ -->
  <view class="mercenaries-section">
    <view class="section-title">ä½£å…µç®¡ç†</view>
    
    <scroll-view scroll-y class="mercenaries-scroll">
      <view wx:for="{{mercenaries}}" wx:key="id" class="merc-item">
        <view class="merc-left">
          <text class="merc-icon-small">{{item.icon}}</text>
          <view class="merc-info-compact">
            <text class="merc-name-small">{{item.name}}</text>
            <text class="merc-count">x{{item.count}}</text>
          </view>
        </view>
        
        <view class="merc-right">
          <view class="merc-dps-info">
            <text class="merc-dps-label">DPS:</text>
            <text class="merc-dps-value">{{item.dpsText}}</text>
          </view>
          <button 
            class="merc-recruit-btn {{item.canAfford ? '' : 'disabled'}}" 
            bindtap="onRecruitMercenary" 
            data-id="{{item.id}}"
            disabled="{{!item.canAfford}}">
            {{item.costText}}
          </button>
        </view>
      </view>
    </scroll-view>
  </view>
  
  <!-- å‡çº§ç‚¹å‡»ä¼¤å®³æŒ‰é’®ï¼ˆç¼©å°ï¼‰ -->
  <view class="upgrade-click-section">
    <button class="upgrade-click-btn" bindtap="onUpgradeClick">
      å‡çº§ç‚¹å‡» ({{upgradeClickCostText}})
    </button>
  </view>
</view>

<!-- ç¦»çº¿æ”¶ç›Šå¼¹çª— -->
<view wx:if="{{showOfflineModal}}" class="modal-overlay" bindtap="closeOfflineModal">
  <view class="modal-content pixel-card" catchtap="preventClose">
    <view class="modal-title">ç¦»çº¿æ”¶ç›Š</view>
    <view class="modal-body">
      <text>ç¦»çº¿æ—¶é—´: {{offlineTimeText}}</text>
      <text>è·å¾—é‡‘å¸: {{offlineGoldText}}</text>
      <text>å‡»è´¥Boss: {{offlineBossesText}}</text>
    </view>
    <button class="pixel-button" bindtap="closeOfflineModal">é¢†å–</button>
  </view>
</view>
